<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>WAFishBiology_vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">WAFishBiology_vignette</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#growth-analysis" id="toc-growth-analysis">Growth
analysis</a>
<ul>
<li><a href="#alternative-growth-models-applied-to-length-and-age-data" id="toc-alternative-growth-models-applied-to-length-and-age-data">Alternative
growth models applied to length and age data</a></li>
<li><a href="#mixture-analysis-using-fish-length-data" id="toc-mixture-analysis-using-fish-length-data">Mixture analysis (using
fish length data)</a></li>
<li><a href="#growth-model-allowing-for-size-related-movements-of-fish" id="toc-growth-model-allowing-for-size-related-movements-of-fish">Growth
model allowing for size-related movements of fish</a></li>
<li><a href="#year-effect-growth-model" id="toc-year-effect-growth-model">Year effect growth model</a></li>
<li><a href="#available-functions-related-to-fish-growth-analysis-using-length-at-age-data-or-length-distribution-data" id="toc-available-functions-related-to-fish-growth-analysis-using-length-at-age-data-or-length-distribution-data">Available
functions related to fish growth analysis using length-at-age data or
length distribution data</a></li>
<li><a href="#alternative-growth-models-for-tag-increment-data" id="toc-alternative-growth-models-for-tag-increment-data">Alternative
growth models for tag increment data</a></li>
<li><a href="#available-functions-related-to-fish-growth-analysis-using-tag-increment-data" id="toc-available-functions-related-to-fish-growth-analysis-using-tag-increment-data">Available
functions related to fish growth analysis using tag increment
data</a></li>
</ul></li>
<li><a href="#analysis-of-fish-weight-length-data" id="toc-analysis-of-fish-weight-length-data">Analysis of fish
weight-length data</a>
<ul>
<li><a href="#available-functions-related-to-analysis-of-fish-weight-and-length-data" id="toc-available-functions-related-to-analysis-of-fish-weight-and-length-data">Available
functions related to analysis of fish weight and length data</a></li>
</ul></li>
<li><a href="#reproductive-analysis" id="toc-reproductive-analysis">Reproductive analysis</a>
<ul>
<li><a href="#logistic-size-and-age-at-maturity-or-sex-change-curves" id="toc-logistic-size-and-age-at-maturity-or-sex-change-curves">Logistic
size and age at maturity (or sex change) curves</a></li>
<li><a href="#available-functions-related-to-analysis-of-fish-length-at-maturity-and-age-at-maturity-or-sex-change-data" id="toc-available-functions-related-to-analysis-of-fish-length-at-maturity-and-age-at-maturity-or-sex-change-data">Available
functions related to analysis of fish length at maturity and age at
maturity (or sex change) data</a></li>
<li><a href="#available-functions-related-to-mean-monthly-gonadosomatic-indices-gsis" id="toc-available-functions-related-to-mean-monthly-gonadosomatic-indices-gsis">Available
functions related to mean monthly gonadosomatic indices GSIs)</a></li>
<li><a href="#available-functions-related-to-mean-monthly-standardised-gonad-weights" id="toc-available-functions-related-to-mean-monthly-standardised-gonad-weights">Available
functions related to mean monthly standardised gonad weights</a></li>
<li><a href="#available-functions-related-to-monthly-prevalences-of-fish-at-different-gonadal-development-stages" id="toc-available-functions-related-to-monthly-prevalences-of-fish-at-different-gonadal-development-stages">Available
functions related to monthly prevalences of fish at different gonadal
development stages</a></li>
<li><a href="#spawning-duration-model" id="toc-spawning-duration-model">Spawning duration model</a></li>
<li><a href="#available-functions-related-to-spawning-duration-model" id="toc-available-functions-related-to-spawning-duration-model">Available
functions related to spawning duration model</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References:</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="last-updated-may-2023-alex-hesp---dpird" class="section level4">
<h4>Last updated May 2023 (Alex Hesp - DPIRD)</h4>
<p>This package is intended as a toolbox of methods for describing
various biological traits of fish and invertebrate species, including
growth, size/age at maturity, weight-length relationships etc., which
represent key information for many model-based fisheries assessments.
The various R functions output a range of statistics and diagnostic
plots. The various biological relationships and associated parameters
are required inputs a range of assessment models, e.g. per recruit
analysis and statistical catch at age (and length) models.</p>
<p>Please note that this is a ‘trial version’ with testing of the
various routines continuing. Please report any identified issues to Alex
Hesp asap <span class="math inline">\((\mathrm{Alex.Hesp@dpird.wa.gov.au})\)</span>.</p>
</div>
<div id="growth-analysis" class="section level2">
<h2>Growth analysis</h2>
<p>Several functions are available that relate to fitting growth curves
to length-at-age data or data derived from length mixture distribution
analysis. The alternative growth models include the von Bertalanffy
growth model (von Bertalanffy, 1938), the generalised growth model of
Schnute (1981) and the seasonal growth curve of Somers (1988). The
routines implemented allow for either a single curve to be fitted to the
data, or two curves (i.e. females and males, or area 1 and area 2) to be
fitted simultaneously. In the latter case, common variance is assumed
for the two curves.</p>
<div id="alternative-growth-models-applied-to-length-and-age-data" class="section level3">
<h3>Alternative growth models applied to length and age data</h3>
<div id="von-bertalanffy-growth-model" class="section level4">
<h4>von Bertalanffy growth model</h4>
<p>Fitting a single von Bertalanffy growth curve to data, <span class="math inline">\(L_t\)</span>, the estimated mean length of fish at
age <span class="math inline">\(t\)</span>, is</p>
<p><span class="math display">\[
L_t = L_\infty(1-\exp(-k(t-t_0)))
\]</span> where <span class="math inline">\(L_\infty\)</span> is the
asymptotic length, <span class="math inline">\(k\)</span> is the growth
coefficient and <span class="math inline">\(t_0\)</span> is the
hypothetical age at zero length.</p>
</div>
<div id="schnute-growth-model" class="section level4">
<h4>Schnute growth model</h4>
<p>Schnute’s growth model includes four parameters, including <span class="math inline">\(a\)</span> (1/time), <span class="math inline">\(b\)</span> (dimensionless) and two sizes <span class="math inline">\(L_1\)</span> and <span class="math inline">\(L_2\)</span>, corresponding to references ages
<span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span>, respectively. Depending on
whether or not <span class="math inline">\(a\)</span> and/or <span class="math inline">\(b\)</span> are equal to zero, the Schnute growth
functions takes one of the following four forms:</p>
<p><span class="math inline">\(a\)</span> &lt;&gt; 0, <span class="math inline">\(b\)</span> &lt;&gt; 0 <span class="math display">\[
L_t
=\biggl[{L_1}^b+({L_2}^b-{L_1}^b)\frac{(1-\exp(-a(t-\tau_1)))}{(1-\exp(-a(\tau_2-\tau_1))}\biggr]^\frac{1}{b}
\]</span> <span class="math inline">\(a\)</span> &lt;&gt; 0, <span class="math inline">\(b\)</span> = 0 <span class="math display">\[
L_t
={L_1}\biggl[\ln(L_2/L_1)\frac{(1-\exp(-a(t-\tau_1)))}{(1-\exp(-a(\tau_2-\tau_1))}\biggr]
\]</span> <span class="math inline">\(a\)</span> = 0, <span class="math inline">\(b\)</span> &lt;&gt; 0 <span class="math display">\[
L_t
=\biggl[{L_1}^b+({L_2}^b-{L_1}^b)\frac{(t-\tau_1)}{(\tau_2-\tau_1)}\biggr]^\frac{1}{b}
\]</span> <span class="math inline">\(a\)</span> = 0, <span class="math inline">\(b\)</span> = 0 <span class="math display">\[
L_t
={L_1}\biggl[\ln(L_2/L_1)\frac{(t-\tau_1)}{(\tau_2-\tau_1)}\biggr]^\frac{1}{b}
\]</span></p>
</div>
<div id="somers-1988-seasonal-growth-curve" class="section level4">
<h4>Somers (1988) seasonal growth curve</h4>
<p>Somers (1988) seasonal growth curve is <span class="math display">\[
L_t = L_\infty(1-\exp(-k(t-t_0)))-S(t)+S(t_0)
\]</span> where <span class="math display">\[
S(t)=\frac{CK}{2\pi} \sin{2\pi}(t-t_s)
\]</span> <span class="math display">\[
S(t_0)=\frac{CK}{2\pi} \sin{2\pi}(t_0-t_s)
\]</span> In the above equations, <span class="math inline">\(C\)</span>
modifies the amplitude of the growth oscillations and <span class="math inline">\(t_s\)</span> represents the time between time 0
and the start of the convex portion of the first sinusoidal growth
oscillation, i.e. the inflection point (see Garcia-Berthou et al.,
2012). If C = 0, then there is no seasonal oscillation and the model
reduces to the typical von Bertalanffy growth model. If C = 1, then
growth completely ceases during one part of the year.</p>
</div>
<div id="objective-function-for-fitting-growth-curves-to-length-at-age-data" class="section level4">
<h4>Objective function for fitting growth curves to length-at-age
data</h4>
<p>The objective function minimised by nlminb is the negative
log-likelihood, calculated as <span class="math display">\[
\lambda=\frac{n}{2}\bigg[\ln(2\pi)+2\ln(\hat{\sigma})+1\bigg]
\]</span> see (e.g. Haddon, 2011). Non-linear regression (employing the
optimisation routine nlminb) is used to fit the growth curve, given a
set of age and length data, and a set of starting values for the von
Bertalanffy growth parameters (Linf, vbK, and tzero):</p>
</div>
<div id="objective-function-for-fitting-growth-curves-to-mean-length-at-age-data" class="section level4">
<h4>Objective function for fitting growth curves to mean length at age
data</h4>
<p>The objective function minimised by nlminb is the negative
log-likelihood, calculated as</p>
<p><span class="math display">\[
\lambda=0.5\log_e(\sigma_M^2+\sigma_P^2)+0.5\log_e(2\pi)+\frac{(X-\mu)^2}{2(\sigma_M^2+\sigma_P^2)}
\]</span> where <span class="math inline">\(X\)</span> is the “observed”
mean size-at-age calculated from the mixture analysis, <span class="math inline">\(\sigma_M^2\)</span> is the variance associated
with the “observed” mean size-at-age from the mixture analysis, <span class="math inline">\(\sigma_P^2\)</span> is an additional process error
variance estimated in the growth curve analysis, and <span class="math inline">\(\mu\)</span> is the estimated mean size-at-age,
according to the growth curve.</p>
</div>
</div>
<div id="mixture-analysis-using-fish-length-data" class="section level3">
<h3>Mixture analysis (using fish length data)</h3>
<p>The model implemented allows normal or gamma mixture distributions to
be fitted to length composition data with up to three modes (assumed to
represent different fish cohorts). For a given length sample with a
single mode, if it can be assumed that these data conform to a normal
distribution, the expected relative proportion of fish in each size
class is calculated as</p>
<p><span class="math display">\[
\hat{P}_{S_i} =
\int_{S_i^-}^{\mathrm{S_i^+}}\frac{1}{\sigma\sqrt{2{\pi}}}\exp\bigg[\frac{(l-\mu^2)}{2\sigma{^2}}\bigg]dl
\]</span> where <span class="math inline">\(l\)</span> is the length of
the fish, <span class="math inline">\(S_i^-\)</span> and <span class="math inline">\(S_i^+\)</span> are the lower and upper bounds of
size class <span class="math inline">\(S_i\)</span>, respectively, and
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and standard
deviation, respectively, of the normal distribution describing the size
distribution (Marks et al., 2020). If the data are assumed to conform to
a gamma distribution, <span class="math inline">\(\hat{P}_{S_i}\)</span>
is calculated as</p>
<p><span class="math display">\[
\hat{P}_{S_i} =
\int_{S_i^-}^{\mathrm{S_i^+}}\frac{1}{\beta^\alpha\Gamma(\alpha)}l^{\alpha-1}\exp(-l/\beta){dl}
\]</span> where where <span class="math inline">\(\alpha\)</span> and
<span class="math inline">\(\beta\)</span> are the ‘scale’ and ‘shape’
parameters, respectively, of the gamma distribution describing the size
data</p>
<p>When two modes are present (assumed to represent 2 age cohorts), the
size frequency data is assumed to represent a random sample from a
multinomial distribution, with the overall size distribution being
comprised of two normal distributions. Using <span class="math inline">\(0^+\)</span> and <span class="math inline">\(1^+\)</span> to represent the values of the
smaller and larger cohort, respectively, <span class="math inline">\(\hat{f}_{S_i}\)</span>, the overall expected
frequency of fish in size class <span class="math inline">\(S_i\)</span>
in the sample is calculated as</p>
<p><span class="math display">\[
\hat{f}_{S_i} =
n\bigg[\hat{P}_{S_i,0+}\phi_{0+}+\hat{P}_{S_i,1+}(1-\phi_{0+})\bigg]
\]</span> where <span class="math inline">\(n\)</span> is the sample
size for the month and <span class="math inline">\(\phi_{0+}\)</span> is
the proportion of fish belonging to the 0+ cohort (estimated as a model
parameter). Where three cohorts are present, <span class="math inline">\(\hat{f}_{S_i}\)</span> is calculated as</p>
<p><span class="math display">\[
\hat{f}_{S_i} =
n\bigg[\hat{P}_{S_i,0+}\phi_{0+}+\hat{P}_{S_i,1+}\phi_{1+}+\hat{P}_{S_i,2+}(1-\phi_{0+}-\phi_{1_+})\bigg]
\]</span> The expected relative proportion of fish in size class <span class="math inline">\(S_i\)</span> is be calculated as</p>
<p><span class="math display">\[
\hat{P_{S_i}}=\hat{f_{S_i}}/\sum_{S_i}\hat{f_{S_i}}
\]</span> #### Objective function for mixture analysis</p>
<p>The mixture distribution model is fitted to the sample data by
minimizing the negative log-likelihood, calculated as</p>
<p><span class="math display">\[
\lambda=\sum{S_i}{f_{S_i}}\log_e(\hat{P_{S_i}})
\]</span> where <span class="math inline">\(f_{S_i}\)</span> is the
observed frequency of fish in size class <span class="math inline">\(S_i\)</span>. Estimates of asymptotic standard
errors (used to calculate approximate 95% confidence limits) for the
estimated model parameters are derived from a variance-covariance
matrix, calculated from the Hessian matrix outputted by nlminb in R. The
estimated model parameter include mean and standard deviation for each
cohort, and also proportion of the catch in the 0+ cohort (when two
cohorts are present) or proportions in the 1+ and 2+ cohorts (when three
cohorts are present).</p>
</div>
<div id="growth-model-allowing-for-size-related-movements-of-fish" class="section level3">
<h3>Growth model allowing for size-related movements of fish</h3>
<p>This is an implementation of the growth model described by Hesp et
al. (2004), to account for potential impacts, on reliability of growth
parameter estimation, of size-related movements of fish between
habitats. Many fish species exhibit an ontogenetic size-related movement
of fish from a juvenile nursery habitat(s), to the adult habitat. Where
fish are sampled in both habitats, this often involves the use of
different sampling gears, and differences in relative sampling
intensities between the different habitats may result in an overall
length and age sample that, collectively, is not representative of the
overall population being sampled. This, in term, has the potential to
result in biased parameter estimates, as shown for Rhabdosargus sarba
(Hesp et al., 2004).</p>
<p>It is assumed that lengths at age of fish in the population are
normally distributed around an overall von Bertalanffy growth curve
describing growth for the population, i.e. <span class="math inline">\(L_t\sim(L_t,\sigma^2)\)</span></p>
<p><span class="math display">\[
\phi(L_t) =
\frac{1}{\sigma_l\sqrt{2{\pi}}}\exp\bigg[\frac{(l-\mu^2)}{2\sigma_l{^2}}\bigg]
\]</span> In the study of Hesp et al. (2004), variation in lengths at
age was assumed to be constant across all expected lengths. This has
been modified slightly in WAFishBiology, to assume a constant CV across
all expected lengths, i.e. with <span class="math inline">\(\sigma\)</span> assumed to increase with
length.</p>
<p>The probability that a fish of length <span class="math inline">\(L_t\)</span> being in habitat type <span class="math inline">\(h\)</span> (<span class="math inline">\(h=h1\)</span> or <span class="math inline">\(h=h2\)</span>) and caught by the sampling
undertaken in that habitat is determined by</p>
<p><span class="math display">\[
p_h(L_t) =
\begin{cases}
1-\psi(L_t,h_1 \rightarrow h_2) &amp; \text{if } h = h_1 \\
\psi(L_t,h_1 \rightarrow h_2) &amp; \text{if } h = h_2 \\
\end{cases}
\]</span> where</p>
<p><span class="math display">\[
\psi = {1/(1+\exp(-\log_e(19)(L-L_{50}^{h_1 \rightarrow
h_2}/(L_{95}^{h_1 \rightarrow h_2}-L_{50}^{h_1 \rightarrow h_2})))}
\]</span> where <span class="math inline">\(L_{50}^{h_1 \rightarrow
h_2}\)</span> and <span class="math inline">\(L_{95}^{h_1 \rightarrow
h_2}\)</span> are the lengths, respectively, at which 50 and 95% of fish
have moved from the initial habitat <span class="math inline">\(h_1\)</span> to the final habitat <span class="math inline">\(h_2\)</span>. The probability density function for
the lengths of fish at age <span class="math inline">\(t\)</span> in
habitat <span class="math inline">\(h\)</span> is approximated by</p>
<p><span class="math display">\[
f(L_t,h)=\frac{p_h(L_t)\phi(L_t)}{\int_{L=\hat{L}_t-5s}^{L=\hat{L}_t+5s}}f(L,h)LdL
\]</span> An adaptive numerical quadrature function (integrate in R) is
used to evaluate the integrals, with the likelihood assocaited with the
observed lengths at age being caluclated as</p>
<p><span class="math display">\[
\lambda=\prod_{j=1}^{n}\mathrm{f(L_t,h)}
\]</span> The model is fitted in R using, firstly, nlminb, and then
optim (Nelda-Mead) function. As shown by Sulin (2012), use of these two
optmisation routines can improve robustness of the model fitting
process, demonstrated by jitter analysis. When fitting the model, the
following parameters are estimated: <span class="math inline">\(L_\infty\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(t_0\)</span>, <span class="math inline">\(L_{50}^{h_1 \rightarrow h_2}\)</span>, <span class="math inline">\(L_{95}^{h_1 \rightarrow h_2}\)</span>, and
constant coefficient of variation for mean lengths at age, <span class="math inline">\(CV\)</span>. Although the original study allowed
for up to 3 habitats, as currently implemented in this package, there
can be only two.</p>
</div>
<div id="year-effect-growth-model" class="section level3">
<h3>Year effect growth model</h3>
<p>This model is broadly based on the year-effects (von Bertalanffy)
growth model described by Cottingham et al. (2016), used by those
researchers for modelling black bream (Acanthopagrus butcheri) in the
Swan River Estuary, WA. Temporal variation is modelled using annual
growth parameters for the asymptotic length parameter and/or growth
coefficient. The model is fitted to multiple years of length-at-age
data. Unlike the model of Cottingham et al. (2016), which includes
parameters describing the lengths at age of fish in each year class at
the start of the sampling period, the current model estimates the
lengths of fish at each age, for this period, based on the traditional
von Bertalanffy growth model (which reduces the number of model
parameters), similar to the growth analysis undertaken for West
Australian dhufish (Glaucosoma hebraicum) in the assessment presented by
Fairclough et al. (2021). The model is fitted in using RTMB (Kristensen,
2025).</p>
<p>The estimated mean length of a fish of sex <span class="math inline">\(s\)</span> at integer age <span class="math inline">\(t\)</span> in the first year, <span class="math inline">\(y=1\)</span>, is calculated according to the
standard von Bertalanffy growth curve, i.e.</p>
<p><span class="math display">\[
\hat{L}_{t,s,y=1} = L_\infty,_{s,y=1}(1-\exp(-k_{s,y=1}(t-t_0)))
\]</span></p>
<p>where <span class="math inline">\(L_\infty,_{s,y=1}\)</span> and
<span class="math inline">\(k_{s,y=1}\)</span> are the sex- and
year-specific asymptotic length and growth coefficient parameters,
respectively, and <span class="math inline">\(t_0\)</span> is the
hypothetical age at zero length, assumed to be common to both sexes. For
subsequent years, the same equation is used to calculate the expected
length at age zero.</p>
<p>For subsequent integer ages in years following the first year, <span class="math inline">\(\hat{L}_{t,s,y}\)</span> is calculated as</p>
<p><span class="math display">\[
\hat{L}_{t,s,y}=\hat{L}_{t-1,s,y-1}+\hat{g}_{\Delta_{t-t-1},s,y}
\]</span> where <span class="math inline">\(\hat{g}_{\Delta_{t-t-1},s,y}\)</span> denotes the
annual growth increment (i.e. growth of fish from integer age <span class="math inline">\(t-1\)</span> to integer age <span class="math inline">\(t\)</span>), calculated as</p>
<p><span class="math display">\[
\hat{g}_{\Delta_{t-t-1},s,y} =
(L_\infty,_{s,y}-\hat{L}_{t-1,s,y-1})(1-\exp(-k_{s,y}))
\]</span> The expected length of a fish of sex <span class="math inline">\(s\)</span> in year <span class="math inline">\(y\)</span>, on its date of capture at decimal age
<span class="math inline">\(a\)</span>, is calculated as</p>
<p><span class="math display">\[
\hat{L}_{a,s,y}=\hat{L}_{t,s,y-1}+\hat{g}_{\Delta_{a-t,s,y}}
\]</span> where <span class="math inline">\(\hat{g}_{\Delta_{t-t-1},s,y}\)</span> is
calculated as</p>
<p><span class="math display">\[
\hat{g}_{\Delta_{a-t},s,y}=(L_\infty_{s,y}-\hat{L}_{t,s,y})(1-\exp(-k_{s,y}(a
- t)))
\]</span></p>
<p>The model assumes that negative growth cannot occur. The possibility
of negative growth (e.g. as may otherwise be calculated if <span class="math inline">\(L_\infty\)</span> has reduced from one year to the
next) is prevented by adjusting <span class="math inline">\(\delta_{t,s,y}\)</span> as follows</p>
<p><span class="math display">\[
\hat{g}_{t,s,y}=\hat{g}_{t,s,y}^*(1/(1+\exp(\phi(0.0001-\hat{g}_{t,s,y}^*))))
\]</span> where <span class="math inline">\(\hat{g}_{t,s,y}^*\)</span>
represents the estimated growth increment, prior to any adjustment.
Above, the value of the slope parameter, <span class="math inline">\(\phi\)</span> was set to</p>
<p><span class="math display">\[
\log_e(19)/\epsilon
\]</span> with <span class="math inline">\(\epsilon\)</span> specified
as 0.1. The resultant value (29.444) for the slope parameter is
relatively steep, which ensures that only values of the annual growth
increment that are negative or very close to negative are set to zero.
This approach avoids any discontinuities in variables tracked by the
model, as can be necessary for optimisation using automatic
differentiation (as with RTMB). The model is fitted by minimising the
negative log-likelihood (<span class="math inline">\(\lambda\)</span>)
associated with the fit to observed length-at-age data for fish caught
over multiple years. Ignoring constants, this may be calculated as</p>
<p><span class="math display">\[
\lambda = -\bigg(\frac{n}{2}\bigg)\log_e\bigg(\frac{SSR}{n}\bigg)
\]</span> with the sum of squared residuals (<span class="math inline">\(SSR\)</span>) is calculated as</p>
<p><span class="math display">\[
SSR=\sum_{j=1}^n(L_{t,s,y}-\hat{L}_{t,s,y})^2
\]</span></p>
</div>
<div id="available-functions-related-to-fish-growth-analysis-using-length-at-age-data-or-length-distribution-data" class="section level3">
<h3>Available functions related to fish growth analysis using
length-at-age data or length distribution data</h3>
<p>Available functions for visualising length-at-age data, and
visualising growth curves fitted to these data are:<br />
SimulateLengthAtAgeData_vonBert()<br />
SimulateLengthAtAgeData_Schnute()<br />
SimulateLengthAtAgeData_SomersSeasonal()<br />
PlotLengthAtAgeData()<br />
PlotFittedGrowthCurve()<br />
CalcLengthAtAge_SomersSeasonalGrowthCurve()<br />
SchnuteGrowthfunction()</p>
<p>The available functions for fitting growth curves to length-at-age
data are:<br />
GetvonBertalanffyGrowthResults()<br />
GetSchnuteGrowthResults()<br />
GetSeasonalGrowthResults()</p>
<p>The available functions related to mixture distribution analyses
are:<br />
GetMixtureModelResults()<br />
PlotMixtureDistnResults()</p>
<p>The available functions related to fitting a growth model allowing
for a size-related movement are:<br />
GetOffMoveGrowthModResults()</p>
<p>The available functions related to fitting a growth model allowing
for time-varying growth are:<br />
SimTimeVaryLenAtAgeDat()<br />
GetOffMoveGrowthModResults()</p>
</div>
<div id="alternative-growth-models-for-tag-increment-data" class="section level3">
<h3>Alternative growth models for tag increment data</h3>
<p>Several models are available for describing growth from tagging data
as follows:</p>
<div id="von-bertalanffy-growth-model---tag-increment-data" class="section level4">
<h4>von Bertalanffy growth model - tag increment data</h4>
<p>Applying the von Bertalanffy growth model, <span class="math inline">\(dL_t/dt\)</span>, the instantaneous rate of change
in length of an individual, given its initial length at age <span class="math inline">\(t\)</span> years, <span class="math inline">\(L_t\)</span>, is</p>
<p><span class="math display">\[
dL_t/dt=(L_{\infty}-L_t)(1-\exp(-k\Delta_t))
\]</span> where <span class="math inline">\(L_\infty\)</span> is the
average maximum length of individuals in the population, <span class="math inline">\(k\)</span> is the growth coefficient, and <span class="math inline">\(\Delta_t\)</span> is a minute number between
capture and recapture (e.g. Haddon, 2011).</p>
</div>
<div id="gompertz-growth-model---tag-increment-data" class="section level4">
<h4>Gompertz growth model - tag increment data</h4>
<p>Fitting the Gompertz growth model, <span class="math inline">\(dL_t/dt\)</span> is estimated as</p>
<p><span class="math display">\[
dL_t/dt=L_{\infty}\bigg(\frac{L_t}{L_{\infty}}\bigg)\exp(-g\Delta_t)
\]</span> where <span class="math inline">\(g\)</span> is a growth
constant (Heliodoniotis et al. 2011).</p>
</div>
<div id="gaussian-function---tag-increment-data" class="section level4">
<h4>Gaussian function - tag increment data</h4>
<p>Using the Gaussian function, <span class="math inline">\(dL_t/dt\)</span> is estimated as</p>
<p><span class="math display">\[
dL_t/dt=A\exp\bigg(\frac{-(L_t-\mu)^2}{2\sigma^2_{GF}}\bigg)
\]</span> where <span class="math inline">\(A\)</span> is the maximum
growth (mm <span class="math inline">\(y^{-1}\)</span>), <span class="math inline">\(\mu\)</span> is the size at maximum growth (mm)
and <span class="math inline">\(\sigma_{GF}\)</span> is the standard
deviation of the distribution of maximum growth vs size (Rogers-Bennett
et al. 2007).</p>
</div>
<div id="double-logistic-curve---tag-increment-data" class="section level4">
<h4>Double logistic curve - tag increment data</h4>
<p>Using the double-logistic curve, <span class="math inline">\(dL_t/dt\)</span> is</p>
<p><span class="math display">\[
dL_t/dt=a\Bigg(1/\bigg[1+\exp(-\log_e(19)(L_t-L_{{50}_1})(L_{{95}_1}-L_{{50}_1})\bigg]\Bigg)
\Bigg(1/\bigg[1+\exp(\log_e(19)(L_t-L_{{50}_2})(L_{{95}_2}-L_{{50}_2})\bigg]\Bigg)
\]</span> where <span class="math inline">\(a\)</span> is the estimated
maximum length increment attained by individuals at any initial length,
<span class="math inline">\(L_{{50}_1}\)</span> is the initial length
midway between the smallest and maximum growth increment on the
ascending limb of the curve, <span class="math inline">\(L_{{95}_1}\)</span> is the initial length at which
95% of the difference between the smallest growth increment and maximum
growth increment on the ascending limb of the curve is reached, <span class="math inline">\(L_{{50}_2}\)</span> is the initial length midway
between the largest and smallest growth increment on the descending limb
of the curve, and <span class="math inline">\(L_{{95}_2}\)</span> is the
initial length at which 95% of the difference between the largest and
smallest growth increment on the descending limb of the curve is
reached.</p>
</div>
<div id="inverse-logistic-curve---tag-increment-data" class="section level4">
<h4>Inverse logistic curve - tag increment data</h4>
<p>The “inverse logistic” curve (e.g. Haddon et al., 2008) is as
described above for the double logistic model, but with only a
descending limb, i.e.</p>
<p><span class="math display">\[
dL_t/dt=a\Bigg(1/\bigg[1+\exp(-\log_e(19)(L_t-L_{{50}_1})(L_{{95}_1}-L_{{50}_1})\bigg]\Bigg)
\]</span></p>
</div>
<div id="exponential-decay-curve---tag-increment-data" class="section level4">
<h4>Exponential decay curve - tag increment data</h4>
<p><span class="math display">\[
dL_t/dt=a\exp(-L_t/\tau)
\]</span> where <span class="math inline">\(a\)</span> is the maximum
length increment attained by individuals at any initial length and <span class="math inline">\(\tau\)</span> is the rate of change in growth with
length. This model is similar to that described by de Lestang (2018),
but with one less parameter, i.e. excluding a term describing the
minimum length increment attained by individuals.</p>
</div>
<div id="calculation-of-expected-lengths-for-tag-increment-data" class="section level4">
<h4>Calculation of expected lengths for tag increment data</h4>
<p>Applying the Gaussian function, for example, if the length of a fish
at time <span class="math inline">\(t=t_0\)</span> is <span class="math inline">\(L_{t=t_0}\)</span>, then its expected length <span class="math inline">\(\hat{L}_{t=t_0+T}\)</span> at time <span class="math inline">\(t=t_0+T\)</span> is</p>
<p><span class="math display">\[
\hat{L}_{t=t_0+T}=\hat{L}_{t=t_0}+\Delta{L_{t_0,t_{0+T}}}=L_{t=t_0}+\int_{t=t_0}^{t=t_0+T}A\exp\bigg(\frac{-(L_t-\mu)^2}{2\sigma^2_{GF}}\bigg)dt
\]</span> where <span class="math inline">\(\hat{L}_{t=t_0+T}\)</span>
is the expected length increment between <span class="math inline">\(t=t_0\)</span> and <span class="math inline">\(t=t_0+T\)</span>. For each tagged individual, this
“initial value problem” is solved using a 4th order Runge-Kutta
algorithm to calculate an estimate of its expected length at its time of
re-measurement given the values of the growth parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2_{GF}\)</span>. The parameters of the
growth model (as described in this example by the above Gaussian
function) are estimated by minimising the negative log-likelihood where
it is assumed that, for individual <span class="math inline">\(j\)</span>, the observed length increment <span class="math inline">\(X_j\)</span> represents a random variable drawn
from the normal distribution about the estimated increment <span class="math inline">\(\hat{X}_j\)</span>, given its initial length and
the time between its tagging and re-measurement. Any of the
above-described growth models for tag increment data can be applied.</p>
</div>
<div id="objective-function-for-models-fitted-to-tag-increment-data" class="section level4">
<h4>Objective function for models fitted to tag increment data</h4>
<p>The overall log-likelihood for the growth curve is calculated as</p>
<p><span class="math display">\[
\lambda=-\frac{n}{2}\bigg[\log_e(2\pi)+2\log_e(\hat{\sigma})+1\bigg]
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of animals
for which measurements were taken of their initial and final length
lengths and <span class="math inline">\(\hat{\sigma}\)</span> is the
standard deviation associated with the deviations between the observed
and predicted final lengths.</p>
</div>
</div>
<div id="available-functions-related-to-fish-growth-analysis-using-tag-increment-data" class="section level3">
<h3>Available functions related to fish growth analysis using tag
increment data</h3>
<p>Available functions for visualising tagging data, and visualising
growth curves fitted to these data are: GetTaggingGrowthModelResults()
PlotFittedTaggingGrowthModelResults(() SimulateTagRecaptureData()</p>
</div>
</div>
<div id="analysis-of-fish-weight-length-data" class="section level2">
<h2>Analysis of fish weight-length data</h2>
<p>The relationship between the natural logarithms of fish weight <span class="math inline">\((W)\)</span> and fish length <span class="math inline">\((L)\)</span> may be described by a linear model,
i.e.</p>
<p><span class="math display">\[
\log_eW=\log_e(a)+b\log_eL
\]</span></p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the parameters of the model. In
this R package, the model is fitted in R using the lm() function, and
the predict() function is use to calculate 95% confidence limits
(associated with the line) and 95% prediction intervals. For plotting,
the data may be back log-transformed. The back-transformed values are
weight are corrected for bias, associated with back-transformation,
calculated as</p>
<p><span class="math display">\[
W=\exp(\log_eW)\exp(0.5\sigma^2)
\]</span> where <span class="math inline">\(\sigma^2\)</span> is the
residual variance, calculated when fitting the linear regression model
to the log-transformed length and weight data.</p>
<div id="available-functions-related-to-analysis-of-fish-weight-and-length-data" class="section level3">
<h3>Available functions related to analysis of fish weight and length
data</h3>
<p>Available functions for visualising fish weight and length data, and
visualising curves fitted to these data are:
GetWeightLengthRegressionResults() PlotWeightLengthRel_LogSpace()
PlotWeightLengthRel_NormalSpace() SimulateWeightLengthData()</p>
</div>
</div>
<div id="reproductive-analysis" class="section level2">
<h2>Reproductive analysis</h2>
<p>A logistic function may be used to describe the probability of a fish
being mature at a given length (or age). The routines implemented allow
for either a single curve to be fitted to the data, or two curves
(i.e. females and males, or area 1 and area 2) to be fitted
simultaneously. In the latter case, common variance is assumed for the
two curves. Several alternative logistic functions are available,
including models with fixed height (at 1), variable height, symmetric
curves and asymmetric curves.</p>
<div id="logistic-size-and-age-at-maturity-or-sex-change-curves" class="section level3">
<h3>Logistic size and age at maturity (or sex change) curves</h3>
<p>The probability, <span class="math inline">\(P\)</span>, of a fish,
of length <span class="math inline">\(L\)</span> being mature, may be
described using the following symmetric logistic function <span class="math display">\[
\rho = {P_{\max}/(1+\exp(-\log_e(19)(L-L_{50})/(L_{95}-L_{50})))}
\]</span> where P_{max} is the maximum proportion of fish that are
mature, <span class="math inline">\(L_{50}\)</span> and <span class="math inline">\(L_{95}\)</span> are the lengths at which 50 and
95% of fish are mature, respectively. The same form of equation may be
used to describe the probability of maturity of fish at age, replacing
<span class="math inline">\(L\)</span> with fish age, and <span class="math inline">\(L_{50}\)</span> and <span class="math inline">\(L_{95}\)</span> with <span class="math inline">\(A_{50}\)</span> and <span class="math inline">\(A_{95}\)</span>, i.e. the ages at which 50 and 95%
of fish are mature, respectively. In cases where <span class="math inline">\(P_{\max}\)</span> can be assumed to be equal to 1,
only two parameters (either <span class="math inline">\(L_{50}\)</span>
and <span class="math inline">\(L_{95}\)</span>, or <span class="math inline">\(A_{50}\)</span> and <span class="math inline">\(A_{95}\)</span>) are input into the model.
Alternatively, the following function, allowing for asymmetry, may be
applied</p>
<p><span class="math display">\[
\rho = {P_{\max}/((1+Q\exp(-BL))^{1/V})}
\]</span> where <span class="math inline">\(P_{max}\)</span>, <span class="math inline">\(Q\)</span>, <span class="math inline">\(B\)</span>
and <span class="math inline">\(v\)</span> are estimated parameters.
Similar to above, where P_{max} can be assumed to equal one, only 3
parameters need to be estimated.</p>
<div id="objective-function-for-fitting-size-or-age-at-maturity-or-sex-change-curves" class="section level4">
<h4>Objective function for fitting size or age at maturity (or sex
change) curves</h4>
<p>The negative log-likelihood associated with the above logistic curve
may be calculated as</p>
<p><span class="math display">\[
\lambda = \sum_{j}X_j[\ln\rho_j+(1-X_j)\ln(1-\rho_j)]
\]</span> where the <span class="math inline">\(j^{th}\)</span> fish was
represented by <span class="math inline">\(X=0\)</span> if it was
immature and <span class="math inline">\(X=1\)</span> if it was mature
(e.g. French et al., 2014). The same form of equation may be used to
describe the probability of a fish being mature given its age. Likewise,
this relationship may also be used to describe the process of sex change
for hermaphroditic species (by length or age), for cases where all fish
undergo sex change if they survive long enough to reach the largest size
class (or oldest age class).</p>
</div>
</div>
<div id="available-functions-related-to-analysis-of-fish-length-at-maturity-and-age-at-maturity-or-sex-change-data" class="section level3">
<h3>Available functions related to analysis of fish length at maturity
and age at maturity (or sex change) data</h3>
<p>Available functions for visualising fish length at maturity and age
at maturity data, and visualising curves fitted to these data</p>
<p>The available functions for visualising size and age at maturity
data, and fitting curves to these data are:<br />
CalcPropMatureAtLength()<br />
CalcPropMatureAtAge()<br />
GetLogisticMaturityCurveResults()<br />
PlotAgeAtMaturityData()<br />
PlotFittedAgeAtMaturityCurve()<br />
PlotLengthAtMaturityData()<br />
PlotFittedLengthAtMaturityCurve()<br />
SimulateLengthAtMaturityData()<br />
SimulateAgeAtMaturityData()</p>
</div>
<div id="available-functions-related-to-mean-monthly-gonadosomatic-indices-gsis" class="section level3">
<h3>Available functions related to mean monthly gonadosomatic indices
GSIs)</h3>
<p>Routines are available for rapid calculation and plotting of mean
monthly gonadosomatic indices (GSIs) and associated 95 percent
confidence limits. As standard in fish biological studies, GSIs for
individual fish are calculated as</p>
<p><span class="math display">\[
GSI = \bigg(\frac{GW}{BW}\bigg)100
\]</span> where <span class="math inline">\(GW\)</span> is the gonad
weight and <span class="math inline">\(BW\)</span> is the total body
weight of the fish. 95% confidence limits for mean monthly gonad weights
are calculated as 1.96 multiplied by their standard errors.</p>
<p>Available functions include:<br />
CalcMeanMonthlyGSIs()<br />
PlotMeanMonthlyGSIs()</p>
</div>
<div id="available-functions-related-to-mean-monthly-standardised-gonad-weights" class="section level3">
<h3>Available functions related to mean monthly standardised gonad
weights</h3>
<p>Trends in mean monthly GSIs can be impacted by variations in the
sizes of fish collected in monthly samples. Thus, some researchers
prefer to consider trends in mean monthly gonad weights (or GSIs) after
they have been standardised for length effects, such as by using Analyis
of Covariance (ANCOVA) linear model or generalised linear model
(e.g. Cossington et al., 2011). WAFishBiology calculates standardised
mean monthly gonad weights (and associated 95% confidence limits), using
the linear model (lm) function within R. The model used to calculate
mean gonad weights according to fish total length and month is</p>
<p><span class="math display">\[
\log_e{GW}_{i,k}=M_k+a{\log_e{L_i}}{\sim} N(0,\sigma^2)
\]</span> where <span class="math inline">\(GW_{i,k}\)</span> is the
standardised gonad weight, <span class="math inline">\(M_k\)</span> is
the month effect and <span class="math inline">\(L_i\)</span> is the
length effect.</p>
<p>Available functions include:<br />
CalcMeanMonthlyStGonadWts()<br />
PlotMeanMonthyStGonadWts()</p>
</div>
<div id="available-functions-related-to-monthly-prevalences-of-fish-at-different-gonadal-development-stages" class="section level3">
<h3>Available functions related to monthly prevalences of fish at
different gonadal development stages</h3>
<p>Some routines have been added for calculation and plotting of monthly
prevalences of fish at different gonadal development stages. Available
functions include:</p>
<p>CalcMonthlyGonadStageProps()<br />
PlotMonthlyGonadStageProps()</p>
</div>
<div id="spawning-duration-model" class="section level3">
<h3>Spawning duration model</h3>
<p>In a recent research study (Evans-Powell et al., 2024) a model was
developed for estimating mean time and duration of spawning, and how
this differs with respect to female fish length. The proportion of
female fish, of a given size, identified as ‘spawning capable’
(i.e. possessing ovaries that, on the basis of macroscopic and/or
histological examination, are classified as mature or spawning) on any
day of the year is described using a bell-shaped curve (which may or may
not be symmetric). The effect of female length on spawning magnitude and
duration is incorporated in the model by modifying the width and height
of a (‘bell-shaped’) double logistic curve in accordance with fish
length. The proportion of spawning capable females on a given day during
the year is estimated as</p>
<p><span class="math display">\[
P=[1+\exp(-s_1(d-b_1))]^{-1}[1+\exp(s_2(d-b_2))]^{-1}H
\]</span></p>
<p>where <span class="math inline">\(s_1\)</span> and <span class="math inline">\(b_1\)</span> are the slope and inflection point
for the ascending curve, respectively, <span class="math inline">\(s_2\)</span> and <span class="math inline">\(b_2\)</span> are the slope and inflection point
for the descending curve, respectively, and <span class="math inline">\(H\)</span> is the maximum height of the double
logistic curve. The times of year (decimal day values) corresponding to
the inflection points of the ascending and descending logistic curve,
for fish of total length <span class="math inline">\(L\)</span>, is
calculated as</p>
<p><span class="math display">\[
b_1=\rho-\kappa_1{L}
\]</span> <span class="math display">\[
b_2=\rho-\kappa_2{L}
\]</span> where <span class="math inline">\(\rho\)</span>, <span class="math inline">\(\kappa_1\)</span> and <span class="math inline">\(\kappa_2\)</span> are model parameters. Spawning
duration, for fish of length <span class="math inline">\(L\)</span>, is
calculated as <span class="math inline">\(b_2-b_1\)</span>. The
parameter <span class="math inline">\(\rho\)</span> represents the time
of peak spawning, assumed to be constant across fish of all sizes. For
fish of total length L, the value of <span class="math inline">\(H\)</span> is calculated as</p>
<p><span class="math display">\[
H=[1+\exp(-s_3(L-b_3))]^{-1}
\]</span></p>
<p>where <span class="math inline">\(b_3\)</span> is the inflection
point and <span class="math inline">\(s_3\)</span> is the slope of the
curve. This variation in height allows the maximum proportion of
spawning fish, during the spawning season, to vary with fish size. The
duration of the main period of spawning, for fish of total length <span class="math inline">\(L\)</span>, is calculated as the difference
between the (decimal day) values of <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span>.</p>
<p>The model is fitted using the nlminb optimiser in R (R Core Team,
2020) by minimising the overall negative log-likelihood. Setting <span class="math inline">\(X_j=1\)</span> if the <span class="math inline">\(jth\)</span> fish possessed pre-spawning or
spawning ovaries, and <span class="math inline">\(X_j=0\)</span> if it
did not possess such gonads, the negative log-likelihood, <span class="math inline">\(\lambda\)</span>, for each model was calculated
as</p>
<p><span class="math display">\[
\lambda = \sum_{j}X_j[\log_e{P_j+0.0001}+(1-X_j)\ln(1-{P_j+0.0001})]
\]</span></p>
<p>(Moore et al., 2007), where <span class="math inline">\(P_j\)</span>
is the probability of the <span class="math inline">\(jth\)</span> fish
being spawning capable, given its size and date of capture. The small
constant 0.0001 was added to prevent natural logarithms being calculated
for any calculated values of <span class="math inline">\(P_j=0\)</span>.
To calculate uncertainty for both is parameters and derived variables,
the fitted model parameters are assumed to conform to a multivariate
normal distribution. A total of a specified number of samples of sets of
values for the fitted parameters are randomly drawn from this
distribution using the mvrnorm function within the MASS package in R
(Venables &amp; Ripley, 2002) and employing the variance-covariance
matrix for the fitted model, calculated from the Hessian matrix produced
by R when fitting the model (see Marks et al., 2021). Estimates of the
lower and upper 95% confidence intervals for each of the fitted
parameters and for each derived variable are calculated as the 2.5th and
97.5th quantiles of the values obtained from the sets of samples
parameter estimates. Given estimates of batch fecundity and spawning
frequency, the estimates of spawning duration can be used to calculate
‘potential annual fecundity’ for multiple spawning fish species with
indeterminate fecundity. As highlighted by Evans-Powell et al. (2023)
and other recent literature, use of fecundity, rather spawning biomass,
may be more appropriate in some assessment models for estimating stocks
status (due to issues associated with hyperallometric scaling of
reproductive output with respect to fish mass). Note that this technique
and associated paper is currently under review.</p>
</div>
<div id="available-functions-related-to-spawning-duration-model" class="section level3">
<h3>Available functions related to spawning duration model</h3>
<p>SimulateSpawningDurationData()<br />
PlotSpawningDurationData()<br />
PlotSpawningDurationModelResults()<br />
CalcDailySpawnProps_SpDurMod()<br />
GetSpawningDurationModelResults()</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References:</h2>
<p>Chapman, D. G., and D. S. Robson. (1960). The analysis of a catch
curve. Biometrics 16:354-368.</p>
<p>Cottingham, A., Hall, N. G. &amp; Potter, I. C. (2016). Factors
influencing growth of Acanthopagrus butcheri (Sparidae) in a eutrophic
estuary have changed over time. Estuarine, Coastal and Shelf Science
168, 29-39.</p>
<p>Cossington, S., Hesp, S. A., Hall, N. G. &amp; Potter, I. C. (2011).
Growth and reproductive biology of the foxfish Bodianus frenchii, a very
long-lived and monandric protogynous hermaphroditic labrid. Journal of
Fish Biology (2010) 77, 600–626.</p>
<p>deLestang, S. (2018). Could warming oceans and increased lobster
biomass rates be affecting growth rates in Australia’s largest lobster
fishery? Bull Mar Sci. 94, 1055–1075.</p>
<p>Evans-Powell, R., Hesp, S. A., Denham, A., Beckley, L. E. (2024).
Implications of big, old, fat, fecund female fish (BOFFFFs) in
sustaining a large demersal teleost species. Fisheries Research.</p>
<p>Fairclough, D. V., Hesp, S. A., Denham, A., Fisher, E. A., Marks, R.,
Ryan, K. L., Lek, E., Allen, R., Crisafulli, B. M. (2021). 2021
assessment of the status of the West Coast Demersal Scalefish Resource.
Fisheries Research Report No. 316 Department of Primary Industries and
Regional Development, Western Australia. 158 pp.</p>
<p>French, B., Potter, I. C., Hesp, S. A., Coulson, P. G. &amp; Hall, N.
G. (2014). Biology of the harlequin fish Othos dentex (Serranidae), with
particular emphasis on sexual pattern and other reproductive
characteristics. Journal of Fish Biology (2014). 84, 106-132.DOI
10.1007/s00227-003-1217-2.</p>
<p>Haddon, M. (2011). Modelling and Quantitative Methods in Fisheries.
Chapman &amp; Hall/CRC.</p>
<p>Hesp, S. A., Hall, N. G. &amp; Potter, I. C. (2004). Size-related
movements of Rhabdosargus sarba in three different environments and
their influence on estimates of von Bertalanffy growth parameters.
Marine Biology 144, 449–462.</p>
<p>Helidoniotis F., Haddon M., Tuck G. ^ Tarbath D. (2011). The relative
suitability of the von Bertalanffy, Gompertz and inverse logistic models
for describing growth in blacklip abalone populations (Haliotis rubra)
in Tasmania, Australia. Fisheries Research 112, 13-21.</p>
<p>Kristensen K (2025). RTMB: ‘R’ Bindings for ‘TMB’_. R package version
1.7, <a href="https://CRAN.R-project.org/package=RTMB" class="uri">https://CRAN.R-project.org/package=RTMB</a>.</p>
<p>Marks, R., Hesp, S. A., Johnston, D., Denham, A. &amp; Loneragan, N.
(2020). Temporal changes in the growth of a crustacean species, Portunus
armatus, in a temperate marine embayment: evidence of density
dependence. ICES Journal of Marine Science 77: 773-790.</p>
<p>Rogers-Bennett L., Rogers D. W. and Schultz S. A. (2007). Modelling
growth and mortality of red abalone (Haliotis rufescens) in northern
California. Journal of Shellfish Research, 26:719-727.</p>
<p>Schnute, J. (1981). A versatile growth model with statistically
stable parameters. Canadian Journal of Fisheries and Aquatic Sciences
38(9) 1128-1140.</p>
<p>Smith, M. W., Then, A. Y., Wor, C., Ralph, G., Pollock, K. H. &amp;
Hoenig, J/. M. (2012) Recommendations for Catch-Curve Analysis, North
American Journal of Fisheries Management, 32:5, 956-967.</p>
<p>Strain, L. W. S., Hesp, S. A., Fabris, F. and Hart, A. M. (2017).
Demographic performance of Brownlip abalone: exploration of wild and
cultured harvest potential. FRDC Project No. 2012/016. Fisheries
Research Report No. 280, Department of Fisheries, Western Australia,
100pp.</p>
<p>Sulin, E. H. (2012). Comparisons of the size and age compositions and
growth of King George Whiting (Sillaginodes punctata) in different
regions of south-western Australia. Masters Thesis. Murdoch
University.</p>
<p>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics
with S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0.</p>
<p>von Bertalanffy, L. (1938). A quantitative theory of organic growth
(inquiries on growth laws. II). Human Biology 10(2), 181-213.</p>
<p>Wakefield, C. B, Williams, A. J., Fisher, E. A., Hall, N. G., Hesp,
S. A., Halafihi, T., Kaltavara, J., Vourey, E., Taylor, B. M., O’Malley,
J. M., Nicol, S. J., Wise, B. W., Newman, S. J. (2020). Fisheries
Research: 230. Published online October.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
